import pandas as pd
import sys
sys.path.append('../common/')
from set_span import set_span
from randomwalk import randomwalk
n = 10
index = pd.date_range(pd.datetime(2017, 1, 1), pd.datetime(2018, 1, 1))
df = randomwalk(60 * 60 * 24 * 300, freq='S').resample('T').ohlc()
# df = pd.DataFrame(np.random.randn(len(index), 4), index=index)
print('---TEST1---\n', set_span(df, start=pd.datetime(2017, 2, 1), end=pd.datetime(2017, 2, 11), freq='H'))
print('---TEST2---\n', set_span(df, periods=n, end=pd.datetime(2017, 5, 1), freq='H'))
print('---TEST3---\n', set_span(df, start=pd.datetime(2017, 2, 1), periods=n, freq='H'))
print('---TEST4---\n', set_span(df, start='first', end='last', freq='H'))
print('---TEST5---\n', set_span(df, start='first', periods=n, freq='H'))
print('---TEST6---\n', set_span(df, end='last', periods=n, freq='H'))

""" OUT
---TEST1---
 DatetimeIndex(['2017-02-01', '2017-02-02', '2017-02-03', '2017-02-04',
               '2017-02-05', '2017-02-06', '2017-02-07', '2017-02-08',
               '2017-02-09', '2017-02-10', '2017-02-11', '2017-02-12',
               '2017-02-13', '2017-02-14', '2017-02-15', '2017-02-16',
               '2017-02-17', '2017-02-18', '2017-02-19', '2017-02-20',
               '2017-02-21', '2017-02-22', '2017-02-23', '2017-02-24',
               '2017-02-25', '2017-02-26', '2017-02-27', '2017-02-28',
               '2017-03-01', '2017-03-02', '2017-03-03', '2017-03-04',
               '2017-03-05', '2017-03-06', '2017-03-07', '2017-03-08',
               '2017-03-09', '2017-03-10', '2017-03-11', '2017-03-12',
               '2017-03-13', '2017-03-14', '2017-03-15', '2017-03-16',
               '2017-03-17', '2017-03-18', '2017-03-19', '2017-03-20',
               '2017-03-21', '2017-03-22', '2017-03-23', '2017-03-24',
               '2017-03-25', '2017-03-26', '2017-03-27', '2017-03-28',
               '2017-03-29', '2017-03-30', '2017-03-31', '2017-04-01',
               '2017-04-02', '2017-04-03', '2017-04-04', '2017-04-05',
               '2017-04-06', '2017-04-07', '2017-04-08', '2017-04-09',
               '2017-04-10', '2017-04-11', '2017-04-12', '2017-04-13',
               '2017-04-14', '2017-04-15', '2017-04-16', '2017-04-17',
               '2017-04-18', '2017-04-19', '2017-04-20', '2017-04-21',
               '2017-04-22', '2017-04-23', '2017-04-24', '2017-04-25',
               '2017-04-26', '2017-04-27', '2017-04-28', '2017-04-29',
               '2017-04-30', '2017-05-01'],
              dtype='datetime64[ns]', freq='D')
---TEST2---
 DatetimeIndex(['2017-04-22', '2017-04-23', '2017-04-24', '2017-04-25',
               '2017-04-26', '2017-04-27', '2017-04-28', '2017-04-29',
               '2017-04-30', '2017-05-01'],
              dtype='datetime64[ns]', freq='D')
---TEST3---
 DatetimeIndex(['2017-02-01', '2017-02-02', '2017-02-03', '2017-02-04',
               '2017-02-05', '2017-02-06', '2017-02-07', '2017-02-08',
               '2017-02-09', '2017-02-10'],
              dtype='datetime64[ns]', freq='D')
---TEST4---
 DatetimeIndex(['2017-04-14', '2017-04-15', '2017-04-16', '2017-04-17',
               '2017-04-18', '2017-04-19', '2017-04-20', '2017-04-21',
               '2017-04-22', '2017-04-23',
               ...
               '2018-01-29', '2018-01-30', '2018-01-31', '2018-02-01',
               '2018-02-02', '2018-02-03', '2018-02-04', '2018-02-05',
               '2018-02-06', '2018-02-07'],
              dtype='datetime64[ns]', length=300, freq='D')
---TEST5---
 DatetimeIndex(['2017-04-14', '2017-04-15', '2017-04-16', '2017-04-17',
               '2017-04-18', '2017-04-19', '2017-04-20', '2017-04-21',
               '2017-04-22', '2017-04-23'],
              dtype='datetime64[ns]', freq='D')
---TEST6---
 DatetimeIndex(['2018-01-29', '2018-01-30', '2018-01-31', '2018-02-01',
               '2018-02-02', '2018-02-03', '2018-02-04', '2018-02-05',
               '2018-02-06', '2018-02-07'],
              dtype='datetime64[ns]', freq='D')
"""