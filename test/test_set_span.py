import pandas as pd
import sys
sys.path.append('../common/')
from stockplot import set_span
from randomwalk import randomwalk
n = 10
index = pd.date_range(pd.datetime(2017, 1, 1), pd.datetime(2018, 1, 1))
df = randomwalk(60 * 60 * 24 * 300, freq='S').resample('T').ohlc()
# df = pd.DataFrame(np.random.randn(len(index), 4), index=index)
print('---TEST1---\n', set_span(df, start=pd.datetime(2017, 2, 1), end=pd.datetime(2017, 2, 11), freq='H'))
print('---TEST2---\n', set_span(df, periods=n, end=pd.datetime(2017, 5, 1), freq='H'))
print('---TEST3---\n', set_span(df, start=pd.datetime(2017, 2, 1), periods=n, freq='H'))
print('---TEST4---\n', set_span(df, start='first', end='last', freq='H'))
print('---TEST5---\n', set_span(df, start='first', periods=n, freq='H'))
print('---TEST6---\n', set_span(df, end='last', periods=n, freq='H'))

""" OUT
---TEST1---
 DatetimeIndex(['2017-02-01 00:00:00', '2017-02-01 01:00:00',
               '2017-02-01 02:00:00', '2017-02-01 03:00:00',
               '2017-02-01 04:00:00', '2017-02-01 05:00:00',
               '2017-02-01 06:00:00', '2017-02-01 07:00:00',
               '2017-02-01 08:00:00', '2017-02-01 09:00:00',
               ...
               '2017-02-10 15:00:00', '2017-02-10 16:00:00',
               '2017-02-10 17:00:00', '2017-02-10 18:00:00',
               '2017-02-10 19:00:00', '2017-02-10 20:00:00',
               '2017-02-10 21:00:00', '2017-02-10 22:00:00',
               '2017-02-10 23:00:00', '2017-02-11 00:00:00'],
              dtype='datetime64[ns]', length=241, freq='H')
---TEST2---
 DatetimeIndex(['2017-04-30 15:00:00', '2017-04-30 16:00:00',
               '2017-04-30 17:00:00', '2017-04-30 18:00:00',
               '2017-04-30 19:00:00', '2017-04-30 20:00:00',
               '2017-04-30 21:00:00', '2017-04-30 22:00:00',
               '2017-04-30 23:00:00', '2017-05-01 00:00:00'],
              dtype='datetime64[ns]', freq='H')
---TEST3---
 DatetimeIndex(['2017-02-01 00:00:00', '2017-02-01 01:00:00',
               '2017-02-01 02:00:00', '2017-02-01 03:00:00',
               '2017-02-01 04:00:00', '2017-02-01 05:00:00',
               '2017-02-01 06:00:00', '2017-02-01 07:00:00',
               '2017-02-01 08:00:00', '2017-02-01 09:00:00'],
              dtype='datetime64[ns]', freq='H')
---TEST4---
 DatetimeIndex(['2017-04-14 00:00:00', '2017-04-14 01:00:00',
               '2017-04-14 02:00:00', '2017-04-14 03:00:00',
               '2017-04-14 04:00:00', '2017-04-14 05:00:00',
               '2017-04-14 06:00:00', '2017-04-14 07:00:00',
               '2017-04-14 08:00:00', '2017-04-14 09:00:00',
               ...
               '2018-02-07 14:00:00', '2018-02-07 15:00:00',
               '2018-02-07 16:00:00', '2018-02-07 17:00:00',
               '2018-02-07 18:00:00', '2018-02-07 19:00:00',
               '2018-02-07 20:00:00', '2018-02-07 21:00:00',
               '2018-02-07 22:00:00', '2018-02-07 23:00:00'],
              dtype='datetime64[ns]', length=7200, freq='H')
---TEST5---
 DatetimeIndex(['2017-04-14 00:00:00', '2017-04-14 01:00:00',
               '2017-04-14 02:00:00', '2017-04-14 03:00:00',
               '2017-04-14 04:00:00', '2017-04-14 05:00:00',
               '2017-04-14 06:00:00', '2017-04-14 07:00:00',
               '2017-04-14 08:00:00', '2017-04-14 09:00:00'],
              dtype='datetime64[ns]', freq='H')
---TEST6---
 DatetimeIndex(['2018-02-07 14:00:00', '2018-02-07 15:00:00',
               '2018-02-07 16:00:00', '2018-02-07 17:00:00',
               '2018-02-07 18:00:00', '2018-02-07 19:00:00',
               '2018-02-07 20:00:00', '2018-02-07 21:00:00',
               '2018-02-07 22:00:00', '2018-02-07 23:00:00'],
              dtype='datetime64[ns]', freq='H')
"""