
平均足を算出する

```python
def heikin_ashi(self):
    """Return HEIKIN ASHI columns"""
    self['hopen'] = (self.open.shift() + self.close.shift()) / 2
    self['hclose'] = (self[['open', 'high', 'low', 'close']]).mean(1)
    self['hhigh'] = self[['high', 'hopen', 'hclose']].max(1)
    self['hlow'] = self[['low', 'hopen', 'hclose']].min(1)
    return self[['hopen', 'hhigh', 'hlow', 'hclose']]


pd.DataFrame.heikin_ashi = heikin_ashi
```


```python
import sys
sys.path.append('../../bin/')
from stockplot import StockPlot
from read_hst import read_hst
```


<script>requirejs.config({paths: { 'plotly': ['https://cdn.plot.ly/plotly-latest.min']},});if(!window.Plotly) {{require(['plotly'],function(plotly) {window.Plotly=plotly;});}}</script>



```python
df = read_hst('/home/u1and0/Data/USDJPY.zip'); df.tail()
```

    Extracting USDJPY.hst...





<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>open</th>
      <th>high</th>
      <th>low</th>
      <th>close</th>
      <th>volume</th>
    </tr>
    <tr>
      <th>time</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2017-11-17 08:32:00</th>
      <td>112.573</td>
      <td>112.584</td>
      <td>112.573</td>
      <td>112.581</td>
      <td>50.0</td>
    </tr>
    <tr>
      <th>2017-11-17 08:33:00</th>
      <td>112.581</td>
      <td>112.583</td>
      <td>112.578</td>
      <td>112.580</td>
      <td>38.0</td>
    </tr>
    <tr>
      <th>2017-11-17 08:34:00</th>
      <td>112.580</td>
      <td>112.583</td>
      <td>112.578</td>
      <td>112.580</td>
      <td>51.0</td>
    </tr>
    <tr>
      <th>2017-11-17 08:35:00</th>
      <td>112.580</td>
      <td>112.580</td>
      <td>112.572</td>
      <td>112.572</td>
      <td>44.0</td>
    </tr>
    <tr>
      <th>2017-11-17 08:36:00</th>
      <td>112.572</td>
      <td>112.574</td>
      <td>112.572</td>
      <td>112.572</td>
      <td>24.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
fx = StockPlot(df)
fx.resample('D')
fx.stock_dataframe.tail()
```

    ../../bin/stockplot.py:34: FutureWarning:
    
    
    .resample() is now a deferred operation
    You called columns(...) on this deferred object which materialized it into a dataframe
    by implicitly taking the mean.  Use .resample(...).mean() instead
    





<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>open</th>
      <th>high</th>
      <th>low</th>
      <th>close</th>
    </tr>
    <tr>
      <th>time</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2017-11-13</th>
      <td>113.456</td>
      <td>113.703</td>
      <td>113.235</td>
      <td>113.612</td>
    </tr>
    <tr>
      <th>2017-11-14</th>
      <td>113.612</td>
      <td>113.899</td>
      <td>113.298</td>
      <td>113.437</td>
    </tr>
    <tr>
      <th>2017-11-15</th>
      <td>113.437</td>
      <td>113.485</td>
      <td>112.466</td>
      <td>112.861</td>
    </tr>
    <tr>
      <th>2017-11-16</th>
      <td>112.862</td>
      <td>113.319</td>
      <td>112.725</td>
      <td>113.041</td>
    </tr>
    <tr>
      <th>2017-11-17</th>
      <td>113.030</td>
      <td>113.131</td>
      <td>112.383</td>
      <td>112.572</td>
    </tr>
  </tbody>
</table>
</div>




```python
start, end = pd.Timestamp('20170531'), pd.Timestamp('20170818')
fx.plot('heikin', start_plot=start, end_plot=end, start_view='first', end_view='last')
fx.show('jupyter')
```


<div id="6ad69fc4-76d0-4a03-8eb9-c04ec82dd812" style="height: 525px; width: 100%;" class="plotly-graph-div"></div><script type="text/javascript">require(["plotly"], function(Plotly) { window.PLOTLYENV=window.PLOTLYENV || {};window.PLOTLYENV.BASE_URL="https://plot.ly";Plotly.newPlot("6ad69fc4-76d0-4a03-8eb9-c04ec82dd812", [{"type": "box", "x": ["2017-06-01", "2017-06-01", "2017-06-01", "2017-06-01", "2017-06-01", "2017-06-01", "2017-06-08", "2017-06-08", "2017-06-08", "2017-06-08", "2017-06-08", "2017-06-08", "2017-06-09", "2017-06-09", "2017-06-09", "2017-06-09", "2017-06-09", "2017-06-09", "2017-06-10", "2017-06-10", "2017-06-10", "2017-06-10", "2017-06-10", "2017-06-10", "2017-06-15", "2017-06-15", "2017-06-15", "2017-06-15", "2017-06-15", "2017-06-15", "2017-06-16", "2017-06-16", "2017-06-16", "2017-06-16", "2017-06-16", "2017-06-16", "2017-06-19", "2017-06-19", "2017-06-19", "2017-06-19", "2017-06-19", "2017-06-19", "2017-06-20", "2017-06-20", "2017-06-20", "2017-06-20", "2017-06-20", "2017-06-20", "2017-06-24", "2017-06-24", "2017-06-24", "2017-06-24", "2017-06-24", "2017-06-24", "2017-06-26", "2017-06-26", "2017-06-26", "2017-06-26", "2017-06-26", "2017-06-26", "2017-06-27", "2017-06-27", "2017-06-27", "2017-06-27", "2017-06-27", "2017-06-27", "2017-06-28", "2017-06-28", "2017-06-28", "2017-06-28", "2017-06-28", "2017-06-28", "2017-06-29", "2017-06-29", "2017-06-29", "2017-06-29", "2017-06-29", "2017-06-29", "2017-06-30", "2017-06-30", "2017-06-30", "2017-06-30", "2017-06-30", "2017-06-30", "2017-07-01", "2017-07-01", "2017-07-01", "2017-07-01", "2017-07-01", "2017-07-01", "2017-07-03", "2017-07-03", "2017-07-03", "2017-07-03", "2017-07-03", "2017-07-03", "2017-07-04", "2017-07-04", "2017-07-04", "2017-07-04", "2017-07-04", "2017-07-04", "2017-07-07", "2017-07-07", "2017-07-07", "2017-07-07", "2017-07-07", "2017-07-07", "2017-07-08", "2017-07-08", "2017-07-08", "2017-07-08", "2017-07-08", "2017-07-08", "2017-07-10", "2017-07-10", "2017-07-10", "2017-07-10", "2017-07-10", "2017-07-10", "2017-07-11", "2017-07-11", "2017-07-11", "2017-07-11", "2017-07-11", "2017-07-11", "2017-07-17", "2017-07-17", "2017-07-17", "2017-07-17", "2017-07-17", "2017-07-17", "2017-07-25", "2017-07-25", "2017-07-25", "2017-07-25", "2017-07-25", "2017-07-25", "2017-07-26", "2017-07-26", "2017-07-26", "2017-07-26", "2017-07-26", "2017-07-26", "2017-08-02", "2017-08-02", "2017-08-02", "2017-08-02", "2017-08-02", "2017-08-02", "2017-08-04", "2017-08-04", "2017-08-04", "2017-08-04", "2017-08-04", "2017-08-04", "2017-08-05", "2017-08-05", "2017-08-05", "2017-08-05", "2017-08-05", "2017-08-05", "2017-08-07", "2017-08-07", "2017-08-07", "2017-08-07", "2017-08-07", "2017-08-07", "2017-08-13", "2017-08-13", "2017-08-13", "2017-08-13", "2017-08-13", "2017-08-13", "2017-08-14", "2017-08-14", "2017-08-14", "2017-08-14", "2017-08-14", "2017-08-14", "2017-08-15", "2017-08-15", "2017-08-15", "2017-08-15", "2017-08-15", "2017-08-15", "2017-08-16", "2017-08-16", "2017-08-16", "2017-08-16", "2017-08-16", "2017-08-16"], "y": [110.669, 110.7885, 111.05474999999998, 111.05474999999998, 111.05474999999998, 111.471, 109.371, 109.582, 109.87625, 109.87625, 109.87625, 110.372, 109.727, 109.881, 110.20125000000002, 110.20125000000002, 110.20125000000002, 110.801, 110.1385, 110.1385, 110.312, 110.312, 110.312, 110.312, 109.258, 109.792, 110.16325, 110.16325, 110.16325, 110.968, 110.2135, 110.2135, 110.94600000000001, 110.94600000000001, 110.94600000000001, 111.406, 110.716, 110.838, 111.16999999999999, 111.16999999999999, 111.16999999999999, 111.589, 111.1875, 111.1875, 111.5015, 111.5015, 111.5015, 111.776, 111.2595, 111.2595, 111.263, 111.263, 111.263, 111.263, 111.11, 111.147, 111.5, 111.5, 111.5, 111.934, 111.452, 111.47800000000001, 112.013, 112.013, 112.013, 112.455, 111.819, 112.07249999999999, 112.19525, 112.19525, 112.19525, 112.405, 111.801, 112.27850000000001, 112.287, 112.287, 112.287, 112.915, 111.719, 112.21600000000001, 112.21825, 112.21825, 112.21825, 112.591, 112.2815, 112.2815, 112.42, 112.42, 112.42, 112.42, 112.049, 112.42, 112.73124999999999, 112.73124999999999, 112.73124999999999, 113.461, 112.70750000000001, 112.70750000000001, 113.19775, 113.19775, 113.19775, 113.44, 113.094, 113.218, 113.5755, 113.5755, 113.5755, 114.168, 113.52000000000001, 113.52000000000001, 113.894, 113.894, 113.894, 113.894, 113.848, 113.8555, 114.002, 114.002, 114.002, 114.291, 113.707, 113.9345, 114.0315, 114.0315, 114.0315, 114.485, 112.318, 112.444, 112.555, 112.555, 112.555, 112.856, 110.817, 111.084, 111.43, 111.43, 111.43, 111.946, 111.05, 111.4785, 111.55975, 111.55975, 111.55975, 112.184, 110.274, 110.29050000000001, 110.57825, 110.57825, 110.57825, 110.973, 109.833, 110.3785, 110.38674999999999, 110.38674999999999, 110.38674999999999, 111.039, 110.3375, 110.3375, 110.666, 110.666, 110.666, 110.666, 110.636, 110.666, 110.73325000000001, 110.73325000000001, 110.73325000000001, 110.908, 109.118, 109.118, 109.147, 109.147, 109.147, 109.147, 109.03, 109.147, 109.38475, 109.38475, 109.38475, 109.789, 109.36, 109.36, 110.17125, 110.17125, 110.17125, 110.837, 110.019, 110.126, 110.44075000000001, 110.44075000000001, 110.44075000000001, 110.938], "whiskerwidth": 0, "boxpoints": false, "fillcolor": "#3D9970", "showlegend": false, "name": "Increasing", "line": {"color": "#3D9970"}}, {"type": "box", "x": ["2017-05-31", "2017-05-31", "2017-05-31", "2017-05-31", "2017-05-31", "2017-05-31", "2017-06-02", "2017-06-02", "2017-06-02", "2017-06-02", "2017-06-02", "2017-06-02", "2017-06-03", "2017-06-03", "2017-06-03", "2017-06-03", "2017-06-03", "2017-06-03", "2017-06-05", "2017-06-05", "2017-06-05", "2017-06-05", "2017-06-05", "2017-06-05", "2017-06-06", "2017-06-06", "2017-06-06", "2017-06-06", "2017-06-06", "2017-06-06", "2017-06-07", "2017-06-07", "2017-06-07", "2017-06-07", "2017-06-07", "2017-06-07", "2017-06-11", "2017-06-11", "2017-06-11", "2017-06-11", "2017-06-11", "2017-06-11", "2017-06-12", "2017-06-12", "2017-06-12", "2017-06-12", "2017-06-12", "2017-06-12", "2017-06-13", "2017-06-13", "2017-06-13", "2017-06-13", "2017-06-13", "2017-06-13", "2017-06-14", "2017-06-14", "2017-06-14", "2017-06-14", "2017-06-14", "2017-06-14", "2017-06-17", "2017-06-17", "2017-06-17", "2017-06-17", "2017-06-17", "2017-06-17", "2017-06-18", "2017-06-18", "2017-06-18", "2017-06-18", "2017-06-18", "2017-06-18", "2017-06-21", "2017-06-21", "2017-06-21", "2017-06-21", "2017-06-21", "2017-06-21", "2017-06-22", "2017-06-22", "2017-06-22", "2017-06-22", "2017-06-22", "2017-06-22", "2017-06-23", "2017-06-23", "2017-06-23", "2017-06-23", "2017-06-23", "2017-06-23", "2017-06-25", "2017-06-25", "2017-06-25", "2017-06-25", "2017-06-25", "2017-06-25", "2017-07-05", "2017-07-05", "2017-07-05", "2017-07-05", "2017-07-05", "2017-07-05", "2017-07-06", "2017-07-06", "2017-07-06", "2017-07-06", "2017-07-06", "2017-07-06", "2017-07-09", "2017-07-09", "2017-07-09", "2017-07-09", "2017-07-09", "2017-07-09", "2017-07-12", "2017-07-12", "2017-07-12", "2017-07-12", "2017-07-12", "2017-07-12", "2017-07-13", "2017-07-13", "2017-07-13", "2017-07-13", "2017-07-13", "2017-07-13", "2017-07-14", "2017-07-14", "2017-07-14", "2017-07-14", "2017-07-14", "2017-07-14", "2017-07-15", "2017-07-15", "2017-07-15", "2017-07-15", "2017-07-15", "2017-07-15", "2017-07-16", "2017-07-16", "2017-07-16", "2017-07-16", "2017-07-16", "2017-07-16", "2017-07-18", "2017-07-18", "2017-07-18", "2017-07-18", "2017-07-18", "2017-07-18", "2017-07-19", "2017-07-19", "2017-07-19", "2017-07-19", "2017-07-19", "2017-07-19", "2017-07-20", "2017-07-20", "2017-07-20", "2017-07-20", "2017-07-20", "2017-07-20", "2017-07-21", "2017-07-21", "2017-07-21", "2017-07-21", "2017-07-21", "2017-07-21", "2017-07-22", "2017-07-22", "2017-07-22", "2017-07-22", "2017-07-22", "2017-07-22", "2017-07-24", "2017-07-24", "2017-07-24", "2017-07-24", "2017-07-24", "2017-07-24", "2017-07-27", "2017-07-27", "2017-07-27", "2017-07-27", "2017-07-27", "2017-07-27", "2017-07-28", "2017-07-28", "2017-07-28", "2017-07-28", "2017-07-28", "2017-07-28", "2017-07-29", "2017-07-29", "2017-07-29", "2017-07-29", "2017-07-29", "2017-07-29", "2017-07-30", "2017-07-30", "2017-07-30", "2017-07-30", "2017-07-30", "2017-07-30", "2017-07-31", "2017-07-31", "2017-07-31", "2017-07-31", "2017-07-31", "2017-07-31", "2017-08-01", "2017-08-01", "2017-08-01", "2017-08-01", "2017-08-01", "2017-08-01", "2017-08-03", "2017-08-03", "2017-08-03", "2017-08-03", "2017-08-03", "2017-08-03", "2017-08-08", "2017-08-08", "2017-08-08", "2017-08-08", "2017-08-08", "2017-08-08", "2017-08-09", "2017-08-09", "2017-08-09", "2017-08-09", "2017-08-09", "2017-08-09", "2017-08-10", "2017-08-10", "2017-08-10", "2017-08-10", "2017-08-10", "2017-08-10", "2017-08-11", "2017-08-11", "2017-08-11", "2017-08-11", "2017-08-11", "2017-08-11", "2017-08-12", "2017-08-12", "2017-08-12", "2017-08-12", "2017-08-12", "2017-08-12", "2017-08-17", "2017-08-17", "2017-08-17", "2017-08-17", "2017-08-17", "2017-08-17", "2017-08-18", "2017-08-18", "2017-08-18", "2017-08-18", "2017-08-18", "2017-08-18"], "y": [110.474, 111.01650000000001, 110.81675, 110.81675, 110.81675, 111.216, 110.32, 111.0395, 110.94749999999999, 110.94749999999999, 110.94749999999999, 111.699, 110.441, 110.88550000000001, 110.441, 110.441, 110.441, 110.88550000000001, 110.217, 110.441, 110.42875, 110.42875, 110.42875, 110.72, 109.216, 110.389, 109.89349999999999, 109.89349999999999, 109.89349999999999, 110.516, 109.106, 109.92099999999999, 109.53525, 109.53525, 109.53525, 109.92099999999999, 110.3, 110.312, 110.3, 110.3, 110.3, 110.312, 109.622, 110.3, 110.0675, 110.0675, 110.0675, 110.429, 109.777, 110.1095, 109.99799999999999, 109.99799999999999, 109.99799999999999, 110.26, 108.799, 109.9775, 109.67875000000001, 109.67875000000001, 109.67875000000001, 110.332, 110.853, 110.871, 110.853, 110.853, 110.853, 110.871, 110.807, 110.853, 110.838, 110.838, 110.838, 110.869, 111.058, 111.4665, 111.4015, 111.4015, 111.4015, 111.728, 110.939, 111.41, 111.26249999999999, 111.26249999999999, 111.26249999999999, 111.437, 111.093, 111.337, 111.25775000000002, 111.25775000000002, 111.25775000000002, 111.419, 111.124, 111.263, 111.14125, 111.14125, 111.14125, 111.263, 112.814, 113.311, 113.24875, 113.24875, 113.24875, 113.675, 112.876, 113.253, 113.19275, 113.19275, 113.19275, 113.459, 113.846, 113.894, 113.85575, 113.85575, 113.85575, 113.894, 112.916, 113.96700000000001, 113.485, 113.485, 113.485, 113.96700000000001, 112.848, 113.534, 113.19250000000001, 113.19250000000001, 113.19250000000001, 113.534, 112.257, 113.203, 112.90350000000001, 112.90350000000001, 112.90350000000001, 113.566, 112.514, 112.8955, 112.514, 112.514, 112.514, 112.8955, 112.444, 112.514, 112.444, 112.444, 112.444, 112.514, 111.675, 112.523, 112.2485, 112.2485, 112.2485, 112.678, 111.545, 112.32050000000001, 111.93449999999999, 111.93449999999999, 111.93449999999999, 112.32050000000001, 111.471, 111.9855, 111.92025000000001, 111.92025000000001, 111.92025000000001, 112.408, 111.002, 111.90100000000001, 111.51950000000001, 111.51950000000001, 111.51950000000001, 112.066, 111.129, 111.505, 111.129, 111.129, 111.129, 111.505, 110.611, 111.129, 111.02175, 111.02175, 111.02175, 111.308, 110.771, 111.5025, 111.2075, 111.2075, 111.2075, 111.7, 110.539, 111.1795, 110.94775, 110.94775, 110.94775, 111.319, 110.723, 110.9665, 110.723, 110.723, 110.723, 110.9665, 110.627, 110.723, 110.6325, 110.6325, 110.6325, 110.723, 110.204, 110.6325, 110.46199999999999, 110.46199999999999, 110.46199999999999, 110.762, 109.912, 110.441, 110.268, 110.268, 110.268, 110.579, 109.851, 110.53299999999999, 110.35600000000001, 110.35600000000001, 110.35600000000001, 110.816, 110.238, 110.6945, 110.5165, 110.5165, 110.5165, 110.818, 109.551, 110.505, 110.062, 110.062, 110.062, 110.505, 109.142, 110.174, 109.62525, 109.62525, 109.62525, 110.174, 108.714, 109.595, 109.098, 109.098, 109.098, 109.595, 109.118, 109.143, 109.118, 109.118, 109.118, 109.143, 109.435, 110.40299999999999, 109.8785, 109.8785, 109.8785, 110.40299999999999, 108.591, 109.8615, 109.22725, 109.22725, 109.22725, 109.8615], "whiskerwidth": 0, "boxpoints": false, "fillcolor": "#FF4136", "showlegend": false, "line": {"color": "#FF4136"}, "name": "Decreasing"}], {"xaxis": {"showgrid": true, "range": [1496188800000.0, 1503014400000.0]}, "yaxis": {"autorange": true}}, {"showLink": true, "linkText": "Export to plot.ly"})});</script>


![image.png](attachment:image.png)


```python
start, end = pd.Timestamp('20170123'), pd.Timestamp('20170404')
fx.plot('heikin', start_plot=start, end_plot=end, start_view='first', end_view='last')
fx.show('jupyter')
```


<div id="9071b347-a69a-4cfa-ac96-09f591869c6b" style="height: 525px; width: 100%;" class="plotly-graph-div"></div><script type="text/javascript">require(["plotly"], function(Plotly) { window.PLOTLYENV=window.PLOTLYENV || {};window.PLOTLYENV.BASE_URL="https://plot.ly";Plotly.newPlot("9071b347-a69a-4cfa-ac96-09f591869c6b", [{"type": "box", "x": ["2017-01-25", "2017-01-25", "2017-01-25", "2017-01-25", "2017-01-25", "2017-01-25", "2017-01-26", "2017-01-26", "2017-01-26", "2017-01-26", "2017-01-26", "2017-01-26", "2017-01-27", "2017-01-27", "2017-01-27", "2017-01-27", "2017-01-27", "2017-01-27", "2017-02-08", "2017-02-08", "2017-02-08", "2017-02-08", "2017-02-08", "2017-02-08", "2017-02-09", "2017-02-09", "2017-02-09", "2017-02-09", "2017-02-09", "2017-02-09", "2017-02-10", "2017-02-10", "2017-02-10", "2017-02-10", "2017-02-10", "2017-02-10", "2017-02-12", "2017-02-12", "2017-02-12", "2017-02-12", "2017-02-12", "2017-02-12", "2017-02-13", "2017-02-13", "2017-02-13", "2017-02-13", "2017-02-13", "2017-02-13", "2017-02-14", "2017-02-14", "2017-02-14", "2017-02-14", "2017-02-14", "2017-02-14", "2017-02-15", "2017-02-15", "2017-02-15", "2017-02-15", "2017-02-15", "2017-02-15", "2017-02-21", "2017-02-21", "2017-02-21", "2017-02-21", "2017-02-21", "2017-02-21", "2017-02-22", "2017-02-22", "2017-02-22", "2017-02-22", "2017-02-22", "2017-02-22", "2017-02-27", "2017-02-27", "2017-02-27", "2017-02-27", "2017-02-27", "2017-02-27", "2017-03-01", "2017-03-01", "2017-03-01", "2017-03-01", "2017-03-01", "2017-03-01", "2017-03-02", "2017-03-02", "2017-03-02", "2017-03-02", "2017-03-02", "2017-03-02", "2017-03-03", "2017-03-03", "2017-03-03", "2017-03-03", "2017-03-03", "2017-03-03", "2017-03-07", "2017-03-07", "2017-03-07", "2017-03-07", "2017-03-07", "2017-03-07", "2017-03-08", "2017-03-08", "2017-03-08", "2017-03-08", "2017-03-08", "2017-03-08", "2017-03-09", "2017-03-09", "2017-03-09", "2017-03-09", "2017-03-09", "2017-03-09", "2017-03-10", "2017-03-10", "2017-03-10", "2017-03-10", "2017-03-10", "2017-03-10", "2017-03-13", "2017-03-13", "2017-03-13", "2017-03-13", "2017-03-13", "2017-03-13", "2017-03-14", "2017-03-14", "2017-03-14", "2017-03-14", "2017-03-14", "2017-03-14", "2017-03-24", "2017-03-24", "2017-03-24", "2017-03-24", "2017-03-24", "2017-03-24", "2017-03-28", "2017-03-28", "2017-03-28", "2017-03-28", "2017-03-28", "2017-03-28", "2017-03-29", "2017-03-29", "2017-03-29", "2017-03-29", "2017-03-29", "2017-03-29", "2017-03-30", "2017-03-30", "2017-03-30", "2017-03-30", "2017-03-30", "2017-03-30", "2017-03-31", "2017-03-31", "2017-03-31", "2017-03-31", "2017-03-31", "2017-03-31"], "y": [113.027, 113.2215, 113.502, 113.502, 113.502, 113.977, 113.039, 113.50200000000001, 113.91075, 113.91075, 113.91075, 114.847, 113.8785, 113.8785, 114.82825, 114.82825, 114.82825, 115.365, 111.621, 112.0405, 112.10475, 112.10475, 112.10475, 112.534, 111.728, 112.132, 112.55325, 112.55325, 112.55325, 113.337, 112.574, 112.574, 113.27425000000001, 113.27425000000001, 113.27425000000001, 113.847, 113.199, 113.199, 113.512, 113.512, 113.512, 113.512, 113.428, 113.512, 113.703, 113.703, 113.703, 114.159, 113.24, 113.6125, 113.92075, 113.92075, 113.92075, 114.488, 113.852, 113.97749999999999, 114.29525, 114.29525, 114.29525, 114.946, 112.9605, 112.9605, 113.38825, 113.38825, 113.38825, 113.767, 112.897, 113.3605, 113.3885, 113.3885, 113.3885, 113.719, 111.908, 112.342, 112.391, 112.391, 112.391, 112.83, 112.29, 112.5075, 113.065, 113.065, 113.065, 114.038, 112.96600000000001, 112.96600000000001, 114.054, 114.054, 114.054, 114.582, 113.888, 114.0035, 114.225, 114.225, 114.225, 114.737, 113.718, 113.8655, 113.92875000000001, 113.92875000000001, 113.92875000000001, 114.143, 113.6, 113.92699999999999, 114.16724999999998, 114.16724999999998, 114.16724999999998, 114.746, 114.16149999999999, 114.16149999999999, 114.62525, 114.62525, 114.62525, 114.967, 114.629, 114.629, 114.95299999999999, 114.95299999999999, 114.95299999999999, 115.493, 114.473, 114.713, 114.74025, 114.74025, 114.74025, 114.908, 114.509, 114.78999999999999, 114.81700000000001, 114.81700000000001, 114.81700000000001, 115.184, 110.616, 111.019, 111.06475, 111.06475, 111.06475, 111.471, 110.168, 110.74600000000001, 110.778, 110.778, 110.778, 111.191, 110.707, 110.8765, 111.0345, 111.0345, 111.0345, 111.302, 110.931, 111.0645, 111.44449999999999, 111.44449999999999, 111.44449999999999, 111.932, 111.232, 111.45750000000001, 111.66775, 111.66775, 111.66775, 112.186], "whiskerwidth": 0, "boxpoints": false, "fillcolor": "#3D9970", "showlegend": false, "name": "Increasing", "line": {"color": "#3D9970"}}, {"type": "box", "x": ["2017-01-23", "2017-01-23", "2017-01-23", "2017-01-23", "2017-01-23", "2017-01-23", "2017-01-24", "2017-01-24", "2017-01-24", "2017-01-24", "2017-01-24", "2017-01-24", "2017-01-30", "2017-01-30", "2017-01-30", "2017-01-30", "2017-01-30", "2017-01-30", "2017-01-31", "2017-01-31", "2017-01-31", "2017-01-31", "2017-01-31", "2017-01-31", "2017-02-01", "2017-02-01", "2017-02-01", "2017-02-01", "2017-02-01", "2017-02-01", "2017-02-02", "2017-02-02", "2017-02-02", "2017-02-02", "2017-02-02", "2017-02-02", "2017-02-03", "2017-02-03", "2017-02-03", "2017-02-03", "2017-02-03", "2017-02-03", "2017-02-06", "2017-02-06", "2017-02-06", "2017-02-06", "2017-02-06", "2017-02-06", "2017-02-07", "2017-02-07", "2017-02-07", "2017-02-07", "2017-02-07", "2017-02-07", "2017-02-16", "2017-02-16", "2017-02-16", "2017-02-16", "2017-02-16", "2017-02-16", "2017-02-17", "2017-02-17", "2017-02-17", "2017-02-17", "2017-02-17", "2017-02-17", "2017-02-20", "2017-02-20", "2017-02-20", "2017-02-20", "2017-02-20", "2017-02-20", "2017-02-23", "2017-02-23", "2017-02-23", "2017-02-23", "2017-02-23", "2017-02-23", "2017-02-24", "2017-02-24", "2017-02-24", "2017-02-24", "2017-02-24", "2017-02-24", "2017-02-28", "2017-02-28", "2017-02-28", "2017-02-28", "2017-02-28", "2017-02-28", "2017-03-04", "2017-03-04", "2017-03-04", "2017-03-04", "2017-03-04", "2017-03-04", "2017-03-06", "2017-03-06", "2017-03-06", "2017-03-06", "2017-03-06", "2017-03-06", "2017-03-11", "2017-03-11", "2017-03-11", "2017-03-11", "2017-03-11", "2017-03-11", "2017-03-12", "2017-03-12", "2017-03-12", "2017-03-12", "2017-03-12", "2017-03-12", "2017-03-15", "2017-03-15", "2017-03-15", "2017-03-15", "2017-03-15", "2017-03-15", "2017-03-16", "2017-03-16", "2017-03-16", "2017-03-16", "2017-03-16", "2017-03-16", "2017-03-17", "2017-03-17", "2017-03-17", "2017-03-17", "2017-03-17", "2017-03-17", "2017-03-19", "2017-03-19", "2017-03-19", "2017-03-19", "2017-03-19", "2017-03-19", "2017-03-20", "2017-03-20", "2017-03-20", "2017-03-20", "2017-03-20", "2017-03-20", "2017-03-21", "2017-03-21", "2017-03-21", "2017-03-21", "2017-03-21", "2017-03-21", "2017-03-22", "2017-03-22", "2017-03-22", "2017-03-22", "2017-03-22", "2017-03-22", "2017-03-23", "2017-03-23", "2017-03-23", "2017-03-23", "2017-03-23", "2017-03-23", "2017-03-27", "2017-03-27", "2017-03-27", "2017-03-27", "2017-03-27", "2017-03-27", "2017-04-03", "2017-04-03", "2017-04-03", "2017-04-03", "2017-04-03", "2017-04-03", "2017-04-04", "2017-04-04", "2017-04-04", "2017-04-04", "2017-04-04", "2017-04-04"], "y": [112.675, 114.6985, 113.49975, 113.49975, 113.49975, 114.6985, 112.513, 113.457, 113.21000000000001, 113.21000000000001, 113.21000000000001, 113.884, 113.44, 114.78399999999999, 114.2155, 114.2155, 114.2155, 114.942, 112.07, 114.24000000000001, 113.13775, 113.13775, 113.13775, 114.24000000000001, 112.628, 113.26400000000001, 113.13225, 113.13225, 113.13225, 113.942, 112.042, 112.9795, 112.8365, 112.8365, 112.8365, 113.35, 112.305, 112.977, 112.781, 112.781, 112.781, 113.448, 111.613, 112.68549999999999, 112.13, 112.13, 112.13, 112.766, 111.583, 112.07050000000001, 112.05774999999998, 112.05774999999998, 112.05774999999998, 112.567, 113.075, 114.19149999999999, 113.6775, 113.6775, 113.6775, 114.297, 112.608, 113.66900000000001, 113.04400000000001, 113.04400000000001, 113.04400000000001, 113.66900000000001, 112.782, 113.03800000000001, 112.98249999999999, 112.98249999999999, 112.98249999999999, 113.227, 112.54, 113.469, 112.96375, 112.96375, 112.96375, 113.469, 111.924, 112.934, 112.38825, 112.38825, 112.38825, 112.945, 111.679, 112.41300000000001, 112.37599999999999, 112.37599999999999, 112.37599999999999, 112.81, 113.799, 114.1375, 113.9485, 113.9485, 113.9485, 114.1375, 113.549, 113.9675, 113.85075, 113.85075, 113.85075, 114.123, 114.654, 114.837, 114.726, 114.726, 114.726, 114.837, 114.713, 114.739, 114.713, 114.713, 114.713, 114.739, 113.163, 114.7875, 114.0275, 114.0275, 114.0275, 114.874, 112.896, 114.0365, 113.2705, 113.2705, 113.2705, 114.0365, 112.554, 113.3245, 112.99674999999999, 112.99674999999999, 112.99674999999999, 113.482, 112.652, 112.9755, 112.66499999999999, 112.66499999999999, 112.66499999999999, 112.9755, 112.446, 112.66499999999999, 112.6265, 112.6265, 112.6265, 112.887, 111.533, 112.5865, 112.15350000000001, 112.15350000000001, 112.15350000000001, 112.858, 110.721, 112.1115, 111.33324999999999, 111.33324999999999, 111.33324999999999, 112.1115, 110.618, 111.4145, 111.05624999999999, 111.05624999999999, 111.05624999999999, 111.569, 110.1, 111.086, 110.6565, 110.6565, 110.6565, 111.086, 110.846, 111.6265, 111.16199999999999, 111.16199999999999, 111.16199999999999, 111.6265, 110.259, 111.112, 110.68974999999999, 110.68974999999999, 110.68974999999999, 111.112], "whiskerwidth": 0, "boxpoints": false, "fillcolor": "#FF4136", "showlegend": false, "line": {"color": "#FF4136"}, "name": "Decreasing"}], {"xaxis": {"showgrid": true, "range": [1485129600000.0, 1491264000000.0]}, "yaxis": {"autorange": true}}, {"showLink": true, "linkText": "Export to plot.ly"})});</script>


![image.png](attachment:image.png)

微妙に違うのなんでだろう
平均足改良の余地あり


```python
fx.stock_dataframe.ix[pd.Timestamp('20170214'), ['hopen', 'hhigh', 'hlow', 'hclose']]
```




    hopen     113.61250
    hhigh     114.48800
    hlow      113.24000
    hclose    113.92075
    Name: 2017-02-14 00:00:00, dtype: float64



dailyfx.comのデータは

2017/2/14

hopen    113.277

hhigh    114.501

hlow     113.274

hclose   113.933


```python
start, end = pd.Timestamp('20170123'), pd.Timestamp('20170404')
fx.plot(start_plot=start, end_plot=end, start_view='first', end_view='last')
fx.show('jupyter')
```


<div id="acd2753f-e2e2-4559-9c4b-1f0f64b74910" style="height: 525px; width: 100%;" class="plotly-graph-div"></div><script type="text/javascript">require(["plotly"], function(Plotly) { window.PLOTLYENV=window.PLOTLYENV || {};window.PLOTLYENV.BASE_URL="https://plot.ly";Plotly.newPlot("acd2753f-e2e2-4559-9c4b-1f0f64b74910", [{"type": "box", "x": ["2017-01-24", "2017-01-24", "2017-01-24", "2017-01-24", "2017-01-24", "2017-01-24", "2017-01-26", "2017-01-26", "2017-01-26", "2017-01-26", "2017-01-26", "2017-01-26", "2017-01-27", "2017-01-27", "2017-01-27", "2017-01-27", "2017-01-27", "2017-01-27", "2017-02-01", "2017-02-01", "2017-02-01", "2017-02-01", "2017-02-01", "2017-02-01", "2017-02-07", "2017-02-07", "2017-02-07", "2017-02-07", "2017-02-07", "2017-02-07", "2017-02-09", "2017-02-09", "2017-02-09", "2017-02-09", "2017-02-09", "2017-02-09", "2017-02-13", "2017-02-13", "2017-02-13", "2017-02-13", "2017-02-13", "2017-02-13", "2017-02-14", "2017-02-14", "2017-02-14", "2017-02-14", "2017-02-14", "2017-02-14", "2017-02-20", "2017-02-20", "2017-02-20", "2017-02-20", "2017-02-20", "2017-02-20", "2017-02-21", "2017-02-21", "2017-02-21", "2017-02-21", "2017-02-21", "2017-02-21", "2017-02-27", "2017-02-27", "2017-02-27", "2017-02-27", "2017-02-27", "2017-02-27", "2017-03-01", "2017-03-01", "2017-03-01", "2017-03-01", "2017-03-01", "2017-03-01", "2017-03-02", "2017-03-02", "2017-03-02", "2017-03-02", "2017-03-02", "2017-03-02", "2017-03-04", "2017-03-04", "2017-03-04", "2017-03-04", "2017-03-04", "2017-03-04", "2017-03-06", "2017-03-06", "2017-03-06", "2017-03-06", "2017-03-06", "2017-03-06", "2017-03-07", "2017-03-07", "2017-03-07", "2017-03-07", "2017-03-07", "2017-03-07", "2017-03-08", "2017-03-08", "2017-03-08", "2017-03-08", "2017-03-08", "2017-03-08", "2017-03-09", "2017-03-09", "2017-03-09", "2017-03-09", "2017-03-09", "2017-03-09", "2017-03-13", "2017-03-13", "2017-03-13", "2017-03-13", "2017-03-13", "2017-03-13", "2017-03-24", "2017-03-24", "2017-03-24", "2017-03-24", "2017-03-24", "2017-03-24", "2017-03-28", "2017-03-28", "2017-03-28", "2017-03-28", "2017-03-28", "2017-03-28", "2017-03-30", "2017-03-30", "2017-03-30", "2017-03-30", "2017-03-30", "2017-03-30"], "y": [112.513, 112.68, 113.763, 113.763, 113.763, 113.884, 113.039, 113.254, 114.503, 114.503, 114.503, 114.847, 114.38, 114.506, 115.062, 115.062, 115.062, 115.365, 112.628, 112.771, 113.188, 113.188, 113.188, 113.942, 111.583, 111.713, 112.368, 112.368, 112.368, 112.567, 111.728, 111.922, 113.226, 113.226, 113.226, 113.337, 113.428, 113.508, 113.717, 113.717, 113.717, 114.159, 113.24, 113.714, 114.241, 114.241, 114.241, 114.488, 112.782, 112.855, 113.066, 113.066, 113.066, 113.227, 113.065, 113.066, 113.655, 113.655, 113.655, 113.767, 111.908, 112.105, 112.721, 112.721, 112.721, 112.83, 112.29, 112.297, 113.635, 113.635, 113.635, 114.038, 113.627, 113.634, 114.373, 114.373, 114.373, 114.582, 113.799, 113.9, 114.035, 114.035, 114.035, 114.06, 113.549, 113.855, 113.876, 113.876, 113.876, 114.123, 113.718, 113.874, 113.98, 113.98, 113.98, 114.143, 113.6, 113.988, 114.335, 114.335, 114.335, 114.746, 114.276, 114.334, 114.924, 114.924, 114.924, 114.967, 114.473, 114.713, 114.867, 114.867, 114.867, 114.908, 110.616, 110.901, 111.271, 111.271, 111.271, 111.471, 110.168, 110.635, 111.118, 111.118, 111.118, 111.191, 110.931, 111.025, 111.89, 111.89, 111.89, 111.932], "whiskerwidth": 0, "boxpoints": false, "fillcolor": "#3D9970", "showlegend": false, "name": "Increasing", "line": {"color": "#3D9970"}}, {"type": "box", "x": ["2017-01-23", "2017-01-23", "2017-01-23", "2017-01-23", "2017-01-23", "2017-01-23", "2017-01-25", "2017-01-25", "2017-01-25", "2017-01-25", "2017-01-25", "2017-01-25", "2017-01-30", "2017-01-30", "2017-01-30", "2017-01-30", "2017-01-30", "2017-01-30", "2017-01-31", "2017-01-31", "2017-01-31", "2017-01-31", "2017-01-31", "2017-01-31", "2017-02-02", "2017-02-02", "2017-02-02", "2017-02-02", "2017-02-02", "2017-02-02", "2017-02-03", "2017-02-03", "2017-02-03", "2017-02-03", "2017-02-03", "2017-02-03", "2017-02-06", "2017-02-06", "2017-02-06", "2017-02-06", "2017-02-06", "2017-02-06", "2017-02-08", "2017-02-08", "2017-02-08", "2017-02-08", "2017-02-08", "2017-02-08", "2017-02-10", "2017-02-10", "2017-02-10", "2017-02-10", "2017-02-10", "2017-02-10", "2017-02-12", "2017-02-12", "2017-02-12", "2017-02-12", "2017-02-12", "2017-02-12", "2017-02-15", "2017-02-15", "2017-02-15", "2017-02-15", "2017-02-15", "2017-02-15", "2017-02-16", "2017-02-16", "2017-02-16", "2017-02-16", "2017-02-16", "2017-02-16", "2017-02-17", "2017-02-17", "2017-02-17", "2017-02-17", "2017-02-17", "2017-02-17", "2017-02-22", "2017-02-22", "2017-02-22", "2017-02-22", "2017-02-22", "2017-02-22", "2017-02-23", "2017-02-23", "2017-02-23", "2017-02-23", "2017-02-23", "2017-02-23", "2017-02-24", "2017-02-24", "2017-02-24", "2017-02-24", "2017-02-24", "2017-02-24", "2017-02-28", "2017-02-28", "2017-02-28", "2017-02-28", "2017-02-28", "2017-02-28", "2017-03-03", "2017-03-03", "2017-03-03", "2017-03-03", "2017-03-03", "2017-03-03", "2017-03-10", "2017-03-10", "2017-03-10", "2017-03-10", "2017-03-10", "2017-03-10", "2017-03-11", "2017-03-11", "2017-03-11", "2017-03-11", "2017-03-11", "2017-03-11", "2017-03-12", "2017-03-12", "2017-03-12", "2017-03-12", "2017-03-12", "2017-03-12", "2017-03-14", "2017-03-14", "2017-03-14", "2017-03-14", "2017-03-14", "2017-03-14", "2017-03-15", "2017-03-15", "2017-03-15", "2017-03-15", "2017-03-15", "2017-03-15", "2017-03-16", "2017-03-16", "2017-03-16", "2017-03-16", "2017-03-16", "2017-03-16", "2017-03-17", "2017-03-17", "2017-03-17", "2017-03-17", "2017-03-17", "2017-03-17", "2017-03-19", "2017-03-19", "2017-03-19", "2017-03-19", "2017-03-19", "2017-03-19", "2017-03-20", "2017-03-20", "2017-03-20", "2017-03-20", "2017-03-20", "2017-03-20", "2017-03-21", "2017-03-21", "2017-03-21", "2017-03-21", "2017-03-21", "2017-03-21", "2017-03-22", "2017-03-22", "2017-03-22", "2017-03-22", "2017-03-22", "2017-03-22", "2017-03-23", "2017-03-23", "2017-03-23", "2017-03-23", "2017-03-23", "2017-03-23", "2017-03-27", "2017-03-27", "2017-03-27", "2017-03-27", "2017-03-27", "2017-03-27", "2017-03-29", "2017-03-29", "2017-03-29", "2017-03-29", "2017-03-29", "2017-03-29", "2017-03-31", "2017-03-31", "2017-03-31", "2017-03-31", "2017-03-31", "2017-03-31", "2017-04-03", "2017-04-03", "2017-04-03", "2017-04-03", "2017-04-03", "2017-04-03", "2017-04-04", "2017-04-04", "2017-04-04", "2017-04-04", "2017-04-04", "2017-04-04"], "y": [112.675, 114.235, 112.679, 112.679, 112.679, 114.41, 113.027, 113.763, 113.241, 113.241, 113.241, 113.977, 113.44, 114.723, 113.757, 113.757, 113.757, 114.942, 112.07, 113.757, 112.771, 112.771, 112.771, 113.953, 112.042, 113.167, 112.787, 112.787, 112.787, 113.35, 112.305, 112.77, 112.601, 112.601, 112.601, 113.448, 111.613, 112.429, 111.712, 111.712, 111.712, 112.766, 111.621, 112.348, 111.916, 111.916, 111.916, 112.534, 112.852, 113.223, 113.175, 113.175, 113.175, 113.847, 113.512, 113.512, 113.512, 113.512, 113.512, 113.512, 113.852, 114.241, 114.142, 114.142, 114.142, 114.946, 113.075, 114.126, 113.212, 113.212, 113.212, 114.297, 112.608, 113.206, 112.87, 112.87, 112.87, 113.492, 112.897, 113.657, 113.281, 113.281, 113.281, 113.719, 112.54, 113.275, 112.593, 112.593, 112.593, 113.447, 111.924, 112.568, 112.116, 112.116, 112.116, 112.945, 111.679, 112.719, 112.296, 112.296, 112.296, 112.81, 113.888, 114.375, 113.9, 113.9, 113.9, 114.737, 114.645, 114.926, 114.748, 114.748, 114.748, 115.493, 114.654, 114.749, 114.729, 114.729, 114.729, 114.772, 114.713, 114.713, 114.713, 114.713, 114.713, 114.713, 114.509, 114.862, 114.713, 114.713, 114.713, 115.184, 113.163, 114.724, 113.349, 113.349, 113.349, 114.874, 112.896, 113.352, 113.297, 113.297, 113.297, 113.537, 112.554, 113.303, 112.648, 112.648, 112.648, 113.482, 112.652, 112.678, 112.652, 112.652, 112.652, 112.678, 112.446, 112.653, 112.52, 112.52, 112.52, 112.887, 111.533, 112.532, 111.691, 111.691, 111.691, 112.858, 110.721, 111.691, 111.138, 111.138, 111.138, 111.783, 110.618, 111.136, 110.902, 110.902, 110.902, 111.569, 110.1, 110.842, 110.65, 110.65, 110.65, 111.034, 110.707, 111.112, 111.017, 111.017, 111.017, 111.302, 111.232, 111.887, 111.366, 111.366, 111.366, 112.186, 110.846, 111.353, 110.871, 110.871, 110.871, 111.578, 110.259, 110.871, 110.71, 110.71, 110.71, 110.919], "whiskerwidth": 0, "boxpoints": false, "fillcolor": "#FF4136", "showlegend": false, "line": {"color": "#FF4136"}, "name": "Decreasing"}], {"xaxis": {"showgrid": true, "range": [1485129600000.0, 1491264000000.0]}, "yaxis": {"autorange": true}}, {"showLink": true, "linkText": "Export to plot.ly"})});</script>


![image.png](attachment:image.png)


```python
fx.stock_dataframe.ix[pd.Timestamp('20170214'), ['open', 'high', 'low', 'close']]
```




    open     113.714
    high     114.488
    low      113.240
    close    114.241
    Name: 2017-02-14 00:00:00, dtype: float64



dailyfx.comのデータは

2017/2/14

open 113.726

high 114.501

low 113.247

close 114.257

...スプレッドかな！（諦）
